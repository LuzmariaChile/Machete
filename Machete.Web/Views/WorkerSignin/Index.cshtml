@model Machete.Web.ViewModel.WorkerSigninViewModel
<script src="@Url.Content("~/Scripts/jquery-ui.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.ui.datepicker.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<link href="@Url.Content("~/Content/jquery-ui-1.8.6.custom.css")" rel="stylesheet" type="text/css" />

<script src="@Url.Content("~/Scripts/jquery.dataTables-1.7.6.min.js")" type="text/javascript"></script>
<link href="@Url.Content("~/Content/dataTables/demo_table.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/dataTables/demo_table_jui.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" media="all" />
<link href="@Url.Content("~/Content/themes/smoothness/jquery-ui-1.7.2.custom.css")"rel="stylesheet" type="text/css" media="all" />

<script src="@Url.Content("~/Scripts/jquery.alerts.js")" type="text/javascript"></script>
<link href="@Url.Content("~/Content/confirm/jquery.alerts.css")" rel="stylesheet" type="text/css" media="screen" />
@{
    ViewBag.Title = "Worker Signin?!";
}
<h2>
    Worker Signin?!</h2>
    @Html.ActionLink("Report?!", "Report", "WorkerSignin")
<table border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td>
            @using (Html.BeginForm())
            {
                @Html.ValidationSummary(true)
                <div class="editor-label">
                    @Html.LabelFor(model => model.dwccardentry)
                </div>
                <div class="editor-field">
                    @Html.TextBox("dwccardentry", "")
                    @Html.ValidationMessageFor(model => model.dwccardentry)
                    @Html.TextBox("dateforsignin",
                        Html.Encode(String.Format("{0:mm/dd/yy}", Model.dateforsignin.ToShortDateString())),
                        new { @class = "ui-datepicker" })
                    @Html.ValidationMessageFor(model => model.dateforsignin)
                </div>
                <p>
                    <input type="submit" value="Signin?!" />
                </p>   
            }
            <table id="myDataTable" class="display">
                <thead>
                <tr>
                    <th></th>
                    <th>dwccardnum</th>
                    <th>firstname1</th>
                    <th>firstname2</th>
                    <th>lastname1</th>
                    <th>lastname2</th>
                    <th>datesignin</th>
                </tr>
                </thead>
                @foreach (var item in Model.workersignins)
                {
                    <tr>
                        <td>@Html.ActionLink("Delete", 
                                             "Delete", 
                                             new { id = item.signinID }, 
                                             new { @class = "confirm_delete"})
                        </td>
                        <td>@item.dwccardnum</td>
                        <td>@item.firstname1</td>
                        <td>@item.firstname2</td>
                        <td>@item.lastname1</td>
                        <td>@item.lastname2</td>
                        <td>@String.Format("{0:MM/dd/yyyy}", item.dateforsignin)</td>
                    </tr>
                }
            </table>
        </td>
        <td>
            <p>
            @Html.Encode("Expiration date: " + String.Format("{0:mm/dd/yyyy}", Model.last_chkin_memberexpirationdate.ToString()))
            </p>
            @if (Model.memberexpired)
            {
                <div style="color: red;">
                <p><strong>@Html.Encode("MEMBERSHIP EXPIRED!")</strong></p>
                </div>
            }
            @if (Model.last_chkin_image.ImageData == null)
            {
                <p>
                    @Html.Label("No image")
                </p>
            }
            else
            {
                <img src="@Url.Action("GetImage", "Image", new { Model.last_chkin_image.ID })" alt="" />
            }
        </td>
    </tr>
</table>
<script type="text/javascript">
    $().ready(function () {
        DatePicker();
        SigninFocus();
        MyTable();
        $('.confirm_delete').click(function (event) { Confirm_button(event, this); });
        //$('#confirm_delete').click(function (event) { event.preventDefault(); });
    });
    function DatePicker() {
        $('.ui-datepicker').datepicker({
            dateFormat: 'mm/dd/yy',
            buttonImage: '@Url.Content("~/Content/calendar.gif")',
            buttonImageOnly: true,
            showOn: "button",
            onClose: function () { SigninFocus(); }
        });
    }
    function SigninFocus() {
        $('#dwccardentry').focus();
    }
    function MyTable() {
        $('#myDataTable').dataTable({
            "bPaginate": true,
            "bLengthChange": true,
            "bFilter": true,
            "bSort": true,
            "bInfo": true,
            "bAutoWidth": false
        });
    }
    function Confirm_button(e, t) {
        e.preventDefault();
        var theHref =  $(t).attr('href');
        $.alerts.okButton = "@Machete.Web.Resources.Workers.deletesubmit";
        jConfirm('@Machete.Web.Resources.Workers.deleteconfirmation',
                     '@Machete.Web.Resources.Workers.deletetitle',
                     function (r) {
                         if (r == true) { window.location = theHref; }
                     });
                     return false;
    }
</script>
