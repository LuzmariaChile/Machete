@model Machete.Domain.Employer
@using Machete.Web.Resources
@{  
    string recType = "employer";
    string idPrefix = recType + Model.ID + "-";
}
@using (Html.BeginForm("Create", "Employer", FormMethod.Post, 
                        new { @id = "employerCreateForm" }))
{
    <div style="float: left;">
        <input type="submit" id="@(idPrefix)Save" 
               value="@Employers.createsubmit"  tabindex="9"/>
    </div>
    @Html.ValidationSummary(true)
    @Html.EditorForModel()
}
<script language="javascript" type="text/javascript">
    $(document).ready(function () {
        //alert("employerCreate doc-ready");
        $('#@(idPrefix)Save').button();
        $.validator.unobtrusive.parseDynamicContent('#employerCreateForm');
        $('#employerName').focus();
        ////////////////////////////////////////////////////////////////
        //
        // Employer Create submit event
        //

        $("#employerCreateForm").submit(function (e) {
            e.preventDefault();
            if ($("#employerCreateForm").valid()) {
                //
                // post create form, open tab for new records
                $.post($(this).attr("action"), $(this).serialize(),
                    function (data) {
                        add_rectab(data.sNewRef,
                                    data.sNewLabel,
                                    M_employerTabs,
                                    true, data.iNewID, 
                                    "@(recType)");
                    }
                );
            }
            //TODO: javascript...need to deal with ajax error

        });
    });
</script>