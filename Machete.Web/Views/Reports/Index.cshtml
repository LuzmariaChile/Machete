@************************************************************************
*** Notes:
*** We will need a model here; also, the button names are generated in
*** Machete by the .resx file values based on the Culture setting...
*** That will have to be changed when we get out of the stub.
*** This goes for ALL buttons/tabs.
*@
@using Machete.Web.Helpers
@using Machete.Domain.Resources
@using Machete.Web.Resources
@using Machete.Service
@{
    System.Globalization.CultureInfo CI = (System.Globalization.CultureInfo)Session["Culture"];
}

<div id="reportTabs">
    <ul>
        <li><a href="#summary" id="summaryTab" >@Machete.Web.Resources.Reports.summaryTab</a> </li>
        <li><a href="#workers" id="workersTab" >@Machete.Web.Resources.Reports.workersTab</a> </li>
        <li><a href="#orders" id="ordersTab" >@Machete.Web.Resources.Reports.ordersTab</a> </li>
        <li><a href="#activities" id="activitiesTab" >@Machete.Web.Resources.Reports.activitiesTab</a> </li>
    </ul>
    <div id="summaryReports">
        <h3><a href="#">Machete Summary Reports</a></h3>
        <div>
            <p>Open the menus below to select different types of summary reports.</p>
            <p id="stayTuned" title="Next update: Print buttons!">Use the buttons at the top of the report to toggle the display.</p>
        </div>
        
        <h3><a href="#">Monthly, With Detail</a></h3>
        <div id="mwdTable">
            <input type="button" value="Data Only" class="formButton" id="dataOnlyBtn" />
            <input type="button" value="Pie Chart" class="formButton" id="pieChartBtn" />
            @Html.TextBox("activeDate", @DateTime.Today.ToShortDateString(), new { @style = "width: 6em;", @class = "ui-datepicker", @id = "mwdDate" })
            <table id="mwdSummaryTable" class="display">
                <thead>
                    <tr>
                        <th>@Machete.Web.Resources.Reports.date</th>
                        <th>@Machete.Web.Resources.Reports.totalSignins</th>
                        <th>@Machete.Web.Resources.Reports.dwcSignins</th>
                        <th>@Machete.Web.Resources.Reports.hhhSignins</th>
                        <th>@Machete.Web.Resources.Reports.dwcDispatch</th>
                        <th>@Machete.Web.Resources.Reports.hhhDispatch</th>
                        <th>@Machete.Web.Resources.Reports.totalHours</th>
                        <th>@Machete.Web.Resources.Reports.totalIncome</th>
                        <th>@Machete.Web.Resources.Reports.avgIncome</th>
                    </tr>
                </thead>
            </table>
            <div id="dataOnlyDiv">
                <h3 style="color:blue;">BLUE FISH</h3>
            </div>
            <div id="sorryNoPieCharts">
                <h3 style="color:red;">Sorry, pie charts aren't available yet! Just wait for the next update!</h3>
            </div>
        </div>
    </div>
    <div id="workers" style="display:none;">
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fUnited_Way_Demographics-Filtered&rs:Command=Render" target="_blank">United Way Demographics</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fActive+workers+sorted+by+MemberID--All+fields&rs:Command=Render" target="_blank">All Workers</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fActive+workers+with+expired+membership+dates&rs:Command=Render" target="_blank">Active workers with expired memberships</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fActive+workers+with+impossible+membership+dates&rs:Command=Render" target="_blank">Active workers with impossible membership dates</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fActive+workers+with+one+or+more+skills&rs:Command=Render" target="_blank">Active workers with specialty skills</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fWorkers-signins+past+membership+expiration&rs:Command=Render" target="_blank">Workers-Signins with expired memberships</a>
        <p />
        <a href="/ReportServer/Pages/ReportView.aspx?%2fWorkers-Yearly+Seattle+HSD+report&rs:Command=Render" target="_blank">Workers-Yearly client profile report</a>
        <p />
        <a href="/ReportServer/Pages/ReportView.aspx?%2fWorkers-Detailed+report&rs:Command=Render" target="_blank">Workers-Detailed Membership report</a>
    </div>
    <div id="orders" style="display:none;">
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fWork+orders-Status+summary+by+day&rs:Command=Render" target="_blank">Daily work order statuses</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fWork+orders-Incomplete+orders&rs:Command=Render" target="_blank">Incomplete Work Orders (List)</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fWork+orders-Status+summary&rs:Command=Render" target="_blank">Monthly work order and assignment statuses (bar charts)</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fYearToYearComparisonReport&rs:Command=Render" target="_blank">Comparison of work orders from 2011 to 2012 by month.</a>
    </div>
    <div id="activities" style="display:none;">
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fActivities-Class+hours+split+by+test+date&rs:Command=Render" target="_blank">Activities-Class hours split by test date</a>
        <p />
        <a href="/ReportServer/Pages/ReportViewer.aspx?%2fActivities-Worker+class+hours+by+month+and+year&rs:Command=Render" target="_blank">Activities-Worker class hours by month and year</a>
    </div>
</div>

<script type="text/javascript">
    // ready or not, we want these
    $('#sorryNoPieCharts').hide();
    $('#mwdSummary').hide();

//    
    $(document).ready(function () {
        //$(function () { $("#stayTuned").tooltip(); }); 
        // for some reason trying to use tooltips breaks the whole page

        ///TABS//////////////////////////////////////|X|
        // the following code creates
        // tabs from listed item tags 
        // in the HTML, by ID $("#id")
        $(function () { $("#reportTabs").tabs() });
        $(function () { $("#summaryReports").accordion() });

        ///SHOW REPORTS/////////////////////////////|X|
        // when these are clicked on, their reports
        // will be shown.
        $('#monthlyWithDetail').click(function () {
            $('#mwdSummary').show();
        });


        ////PIE CHARTS/////////////////////////|X|
        // Buttons for showing and hiding
        // the Pie Charts feature ...
        // ... which doesn't exist yet!
        $('#dataOnlyBtn').click(function () {
            $('#sorryNoPieCharts').hide();
        });

        $('#pieChartBtn').click(function () {
            $('#sorryNoPieCharts').show();
        });

        // the date-picker
        $('.ui-datepicker').datepicker({
            dateFormat: 'mm/dd/yy'
        });


        ////AND THEN, ALL HELL BREAKS LOOSE////|X|
        // Datatables uses something called Hungarian
        // notation wherein they put the purpose of
        // a given variable to the left of the
        // variable name. E.g., i is integer, o is
        // object. More at datatables.net.
        $('#mwdSummaryTable').dataTable({
            "bPaginate": false, // to enable pagination (this report has fixed size)
            //"bLengthChange": true, //requires pagination
            //"aLengthMenu": [[35, 70, 105, -1], [35, 70, 105, dataSourceLength*]],
            //"iDisplayLength": -1, //number of rows to use with pagination
            "bAutoWidth": false,
            "bInfo": true, //shows information about data being displayed on the page
            "bSort": false, //enable or disable sorting of columns
            "bFilter": false, //enable or disable filtering of data
            "bServerSide": true, //server side processing, req. source
            "sAjaxSource": "/Reports/AjaxMwd", //source for server side processing
            "bProcessing": true, //enable processing indicator [==========       ] 60% done etc.
            "oLanguage": datatable_lang_@(CI.TwoLetterISOLanguageName), //internationalisation
            "aoColumns": [
                { mDataProp: "date" },
                { mDataProp: "totalSignins" },
                { mDataProp: "totalDWCSignins" },
                { mDataProp: "totalHHHSignins" },
                { mDataProp: "dispatchedDWCSignins" },
                { mDataProp: "dispatchedHHHSignins" },
                { mDataProp: "totalHours" },
                { mDataProp: "totalIncome" },
                { mDataProp: "avgIncomePerHour" }
            ], //these are the column names in the array
            //"fnServerData": function (sSource, aoData, fnCallback) {
            //    $.getJSON(sSource,
            //        [{ "name": "mwdDate", "value": $("#mwdDate").val() }],
            //        function (json) { fnCallback(json) });
            //  
            //},
        });
        //end hell
    });
    // end document ready

</script>

