@model Machete.Domain.WorkAssignment
@using Machete.Web.Resources
@{    
    string recType = "assignment";  
}
@using (Html.BeginForm("Create", "WorkAssignment", FormMethod.Post,
                        new { @id = "workAssignmentCreateForm-wo-" + Model.workOrderID}))
{
        <input type="submit" id="workAssignmentCreateButton-wo-@(Model.workOrderID)" class="formButton"
               value="@WorkAssignments.createsubmit" tabindex="9"/>
        @Html.ValidationSummary(true)
        @Html.EditorForModel()
}
<script language="javascript" type="text/javascript">
    $(document).ready(function () {
        $('#activateWorkOrderButton-@(Model.workOrderID)').hide();
        //jquery'ify the buttons
        $('.formButton').button();
        //Run MS validation on dynamic content        
        $.validator.unobtrusive.parseDynamicContent('#workAssignmentCreateForm-wo-@(Model.workOrderID)');
        // Find tabindex attribute (for tab order, not jquery tabs) and increment by 10
//        $('#workAssignmentCreateForm-wo-@(Model.workOrderID) [tabindex]').each(function () {
//            $(this).attr('tabindex', parseInt($(this).attr('tabindex')) + 20) 
//        });
        ////////////////////////////////////////////////////////////////
        //
        //
        //
        $('#workAssignmentCreateForm-wo-@(Model.workOrderID)').mUI('waFormConfiguration');
        ////////////////////////////////////////////////////////////////
        //
        // WorkOrder Create submit event
        //
        $('#workAssignmentCreateForm-wo-@(Model.workOrderID)').submit(function (e) {
            if ($("#workAssignmentCreateForm-wo-@(Model.workOrderID)").valid()) {
                e.preventDefault();
                $.post($(this).attr("action"), $(this).serialize(),
                    function (data) {
                        add_rectab(data.sNewRef, data.sNewLabel, $('#workAssignTabs-wo-@(Model.ID)'), false, data.iNewID, "@(recType)");
                    }
                );
            }
            //TODO: javascript...need to deal with ajax error

        });
    });

</script>